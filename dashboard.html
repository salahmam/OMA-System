<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ù†Ø¸Ø§Ù… Ø£ÙˆÙ…Ø§</title>
<link rel="stylesheet" href="style.css">
<style>
  body {
    font-family: 'Cairo', sans-serif;
    margin:0;
    background: #f0f4ff;
    color: #1a1a1a;
  }
  header {
    background-color: #004aad;
    color:white;
    padding:15px 30px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    box-shadow:0 4px 8px rgba(0,0,0,0.1);
  }
  header h1 { margin:0; font-size:24px; }
  .container {
    max-width:1200px;
    margin:auto;
    padding:20px;
  }
  .welcome {
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:30px;
  }
  .welcome p { font-size:18px; }
  .logout-btn {
    background-color:#e53935;
    color:white;
    border:none;
    padding:10px 20px;
    border-radius:8px;
    cursor:pointer;
    font-size:16px;
    transition:0.3s;
  }
  .logout-btn:hover { background-color:#c62828; }
  .cards {
    display:grid;
    grid-template-columns: repeat(auto-fit,minmax(200px,1fr));
    gap:20px;
  }
  .card {
    background:#004aad;
    color:white;
    padding:30px;
    border-radius:12px;
    text-align:center;
    cursor:pointer;
    transition:0.3s;
    box-shadow:0 4px 12px rgba(0,0,0,0.15);
  }
  .card:hover {
    background:#00337a;
    transform:translateY(-5px);
    box-shadow:0 6px 16px rgba(0,0,0,0.25);
  }
  .card h3 { margin-bottom:10px; }
  .card p { font-size:18px; font-weight:500; }
  footer {
    text-align:center;
    margin-top:30px;
    color:#777;
    font-size:14px;
    padding:15px 0;
    background:#004aad;
    color:white;
  }
  @media(max-width:768px){
    header { flex-direction:column; align-items:flex-start; }
    .cards { grid-template-columns:1fr; }
  }
</style>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAEMoMQDiLffCCJWybFJFQ-b9iHajimme0",
    authDomain: "oma-system-30813.firebaseapp.com",
    projectId: "oma-system-30813",
    storageBucket: "oma-system-30813.appspot.com",
    messagingSenderId: "905224657062",
    appId: "1:905224657062:web:584b3e72e4cc2c58ea3c67",
    measurementId: "G-645066LLLP"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø© + Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  onAuthStateChanged(auth, async (user)=>{
    if(user){
      document.getElementById('userEmail').innerText = user.email;
      const token = await user.getIdTokenResult();
      const currentInstituteId = localStorage.getItem("currentInstituteId");

      // Ø¬Ù„Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¹Ù‡Ø¯
      if(currentInstituteId){
        const docRef = doc(db,"institutes",currentInstituteId);
        const docSnap = await getDoc(docRef);
        if(docSnap.exists()){
          const settings = docSnap.data();
          // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù„ÙˆØ§Ù†
          document.body.style.background = settings.backgroundColor || "#f0f4ff";
          document.body.style.color = settings.textColor || "#1a1a1a";
          document.querySelector('header').style.backgroundColor = settings.primaryColor || "#004aad";
          document.querySelectorAll('.card').forEach(c=>{
            c.style.backgroundColor = settings.primaryColor || "#004aad";
          });
        }
      }

    }else{
      window.location.href="login.html";
    }
  });

  // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
  window.logout = async function(){
    try{
      await signOut(auth);
      window.location.href="login.html";
    }catch(e){ console.error(e); }
  };
</script>
</head>
<body>

<header>
  <h1>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ù†Ø¸Ø§Ù… Ø£ÙˆÙ…Ø§</h1>
</header>

<div class="container">
  <div class="welcome">
    <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span id="userEmail">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span></p>
    <button class="logout-btn" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
  </div>

  <div class="cards">
    <div class="card" onclick="window.location.href='students-v2.html'">
      <h3>ğŸ“š Ø§Ù„Ø·Ù„Ø§Ø¨</h3>
      <p>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</p>
    </div>

    <div class="card" onclick="window.location.href='teachers.html'">
      <h3>ğŸ‘©â€ğŸ« Ø§Ù„Ø£Ø³Ø§ØªØ°Ø©</h3>
      <p>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø§ØªØ°Ø© ÙˆØ§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª</p>
    </div>

    <div class="card" onclick="window.location.href='lessons.html'">
      <h3>ğŸ“– Ø§Ù„Ø¯Ø±ÙˆØ³</h3>
      <p>Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ø±ÙˆØ³ ÙˆÙ…ÙˆØ§Ø¹ÙŠØ¯Ù‡Ø§</p>
    </div>

    <div class="card" onclick="window.location.href='reports.html'">
      <h3>ğŸ“„ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h3>
      <p>Ø¹Ø±Ø¶ ÙˆØ·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</p>
    </div>

    <div class="card" onclick="window.location.href='stats.html'">
      <h3>ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h3>
      <p>Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© ÙˆØ§Ù„Ù…Ù„Ø®ØµØ§Øª</p>
    </div>

    <div class="card" onclick="window.location.href='settings.html'">
      <h3>âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
      <p>Ø¥Ø¯Ø§Ø±Ø© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</p>
    </div>
  </div>

</div>

<footer>
  <p>Â© 2025 Ù†Ø¸Ø§Ù… Ø£ÙˆÙ…Ø§ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
</footer>

</body>
</html>